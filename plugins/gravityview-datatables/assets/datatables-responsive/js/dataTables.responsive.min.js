!function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root||(root=window),$&&$.fn.dataTable||($=require("datatables.net")(root,$).$),factory($,root,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){"use strict";var DataTable=$.fn.dataTable,Responsive=function(settings,opts){if(!DataTable.versionCheck||!DataTable.versionCheck("1.10.3"))throw"DataTables Responsive requires DataTables 1.10.3 or newer";this.s={dt:new DataTable.Api(settings),columns:[],current:[]},this.s.dt.settings()[0].responsive||(opts&&"string"==typeof opts.details?opts.details={type:opts.details}:opts&&opts.details===!1?opts.details={type:!1}:opts&&opts.details===!0&&(opts.details={type:"inline"}),this.c=$.extend(!0,{},Responsive.defaults,DataTable.defaults.responsive,opts),settings.responsive=this,this._constructor())};$.extend(Responsive.prototype,{_constructor:function(){var that=this,dt=this.s.dt,dtPrivateSettings=dt.settings()[0],oldWindowWidth=$(window).width();dt.settings()[0]._responsive=this,$(window).on("resize.dtr orientationchange.dtr",DataTable.util.throttle(function(){var width=$(window).width();width!==oldWindowWidth&&(that._resize(),oldWindowWidth=width)})),dtPrivateSettings.oApi._fnCallbackReg(dtPrivateSettings,"aoRowCreatedCallback",function(tr,data,idx){-1!==$.inArray(!1,that.s.current)&&$("td, th",tr).each(function(i){var idx=dt.column.index("toData",i);that.s.current[idx]===!1&&$(this).css("display","none")})}),dt.on("destroy.dtr",function(){dt.off(".dtr"),$(dt.table().body()).off(".dtr"),$(window).off("resize.dtr orientationchange.dtr"),$.each(that.s.current,function(i,val){val===!1&&that._setColumnVis(i,!0)})}),this.c.breakpoints.sort(function(a,b){return a.width<b.width?1:a.width>b.width?-1:0}),this._classLogic(),this._resizeAuto();var details=this.c.details;details.type!==!1&&(that._detailsInit(),dt.on("column-visibility.dtr",function(e,ctx,col,vis){that._classLogic(),that._resizeAuto(),that._resize()}),dt.on("draw.dtr",function(){that._redrawChildren()}),$(dt.table().node()).addClass("dtr-"+details.type)),dt.on("column-reorder.dtr",function(e,settings,details){that._classLogic(),that._resizeAuto(),that._resize()}),dt.on("column-sizing.dtr",function(){that._resize()}),dt.on("init.dtr",function(e,settings,details){that._resizeAuto(),that._resize(),$.inArray(!1,that.s.current)&&dt.columns.adjust()}),this._resize()},_columnsVisiblity:function(breakpoint){var i,ien,dt=this.s.dt,columns=this.s.columns,order=columns.map(function(col,idx){return{columnIdx:idx,priority:col.priority}}).sort(function(a,b){return a.priority!==b.priority?a.priority-b.priority:a.columnIdx-b.columnIdx}),display=$.map(columns,function(col){return col.auto&&null===col.minWidth?!1:col.auto===!0?"-":-1!==$.inArray(breakpoint,col.includeIn)}),requiredWidth=0;for(i=0,ien=display.length;ien>i;i++)display[i]===!0&&(requiredWidth+=columns[i].minWidth);var scrolling=dt.settings()[0].oScroll,bar=scrolling.sY||scrolling.sX?scrolling.iBarWidth:0,widthAvailable=dt.table().container().offsetWidth-bar,usedWidth=widthAvailable-requiredWidth;for(i=0,ien=display.length;ien>i;i++)columns[i].control&&(usedWidth-=columns[i].minWidth);var empty=!1;for(i=0,ien=order.length;ien>i;i++){var colIdx=order[i].columnIdx;"-"===display[colIdx]&&!columns[colIdx].control&&columns[colIdx].minWidth&&(empty||usedWidth-columns[colIdx].minWidth<0?(empty=!0,display[colIdx]=!1):display[colIdx]=!0,usedWidth-=columns[colIdx].minWidth)}var showControl=!1;for(i=0,ien=columns.length;ien>i;i++)if(!columns[i].control&&!columns[i].never&&!display[i]){showControl=!0;break}for(i=0,ien=columns.length;ien>i;i++)columns[i].control&&(display[i]=showControl);return-1===$.inArray(!0,display)&&(display[0]=!0),display},_classLogic:function(){var that=this,breakpoints=this.c.breakpoints,dt=this.s.dt,columns=dt.columns().eq(0).map(function(i){var column=this.column(i),className=column.header().className,priority=dt.settings()[0].aoColumns[i].responsivePriority;if(priority===undefined){var dataPriority=$(column.header()).data("priority");priority=dataPriority!==undefined?1*dataPriority:1e4}return{className:className,includeIn:[],auto:!1,control:!1,never:!!className.match(/\bnever\b/),priority:priority}}),add=function(colIdx,name){var includeIn=columns[colIdx].includeIn;-1===$.inArray(name,includeIn)&&includeIn.push(name)},column=function(colIdx,name,operator,matched){var size,i,ien;if(operator){if("max-"===operator)for(size=that._find(name).width,i=0,ien=breakpoints.length;ien>i;i++)breakpoints[i].width<=size&&add(colIdx,breakpoints[i].name);else if("min-"===operator)for(size=that._find(name).width,i=0,ien=breakpoints.length;ien>i;i++)breakpoints[i].width>=size&&add(colIdx,breakpoints[i].name);else if("not-"===operator)for(i=0,ien=breakpoints.length;ien>i;i++)-1===breakpoints[i].name.indexOf(matched)&&add(colIdx,breakpoints[i].name)}else columns[colIdx].includeIn.push(name)};columns.each(function(col,i){for(var classNames=col.className.split(" "),hasClass=!1,k=0,ken=classNames.length;ken>k;k++){var className=$.trim(classNames[k]);if("all"===className)return hasClass=!0,void(col.includeIn=$.map(breakpoints,function(a){return a.name}));if("none"===className||col.never)return void(hasClass=!0);if("control"===className)return hasClass=!0,void(col.control=!0);$.each(breakpoints,function(j,breakpoint){var brokenPoint=breakpoint.name.split("-"),re=new RegExp("(min\\-|max\\-|not\\-)?("+brokenPoint[0]+")(\\-[_a-zA-Z0-9])?"),match=className.match(re);match&&(hasClass=!0,match[2]===brokenPoint[0]&&match[3]==="-"+brokenPoint[1]?column(i,breakpoint.name,match[1],match[2]+match[3]):match[2]!==brokenPoint[0]||match[3]||column(i,breakpoint.name,match[1],match[2]))})}hasClass||(col.auto=!0)}),this.s.columns=columns},_detailsDisplay:function(row,update){var that=this,dt=this.s.dt,details=this.c.details;if(details&&details.type){var res=details.display(row,update,function(){return details.renderer(dt,row[0],that._detailsObj(row[0]))});res!==!0&&res!==!1||$(dt.table().node()).triggerHandler("responsive-display.dt",[dt,row,res,update])}},_detailsInit:function(){var that=this,dt=this.s.dt,details=this.c.details;"inline"===details.type&&(details.target="td:first-child, th:first-child"),dt.on("draw.dtr",function(){that._tabIndexes()}),that._tabIndexes(),$(dt.table().body()).on("keyup.dtr","td, th",function(e){13===e.keyCode&&$(this).data("dtr-keyboard")&&$(this).click()});var target=details.target,selector="string"==typeof target?target:"td, th";$(dt.table().body()).on("click.dtr mousedown.dtr mouseup.dtr",selector,function(e){if($(dt.table().node()).hasClass("collapsed")&&dt.row($(this).closest("tr")).length){if("number"==typeof target){var targetIdx=0>target?dt.columns().eq(0).length+target:target;if(dt.cell(this).index().column!==targetIdx)return}var row=dt.row($(this).closest("tr"));"click"===e.type?that._detailsDisplay(row,!1):"mousedown"===e.type?$(this).css("outline","none"):"mouseup"===e.type&&$(this).blur().css("outline","")}})},_detailsObj:function(rowIdx){var that=this,dt=this.s.dt;return $.map(this.s.columns,function(col,i){return col.never?void 0:{title:dt.settings()[0].aoColumns[i].sTitle,data:dt.cell(rowIdx,i).render(that.c.orthogonal),hidden:dt.column(i).visible()&&!that.s.current[i],columnIndex:i,rowIndex:rowIdx}})},_find:function(name){for(var breakpoints=this.c.breakpoints,i=0,ien=breakpoints.length;ien>i;i++)if(breakpoints[i].name===name)return breakpoints[i]},_redrawChildren:function(){var that=this,dt=this.s.dt;dt.rows({page:"current"}).iterator("row",function(settings,idx){dt.row(idx);that._detailsDisplay(dt.row(idx),!0)})},_resize:function(){var i,ien,that=this,dt=this.s.dt,width=$(window).width(),breakpoints=this.c.breakpoints,breakpoint=breakpoints[0].name,columns=this.s.columns,oldVis=this.s.current.slice();for(i=breakpoints.length-1;i>=0;i--)if(width<=breakpoints[i].width){breakpoint=breakpoints[i].name;break}var columnsVis=this._columnsVisiblity(breakpoint);this.s.current=columnsVis;var collapsedClass=!1;for(i=0,ien=columns.length;ien>i;i++)if(columnsVis[i]===!1&&!columns[i].never&&!columns[i].control){collapsedClass=!0;break}$(dt.table().node()).toggleClass("collapsed",collapsedClass);var changed=!1;dt.columns().eq(0).each(function(colIdx,i){columnsVis[i]!==oldVis[i]&&(changed=!0,that._setColumnVis(colIdx,columnsVis[i]))}),changed&&(this._redrawChildren(),$(dt.table().node()).trigger("responsive-resize.dt",[dt,this.s.current]))},_resizeAuto:function(){var dt=this.s.dt,columns=this.s.columns;if(this.c.auto&&-1!==$.inArray(!0,$.map(columns,function(c){return c.auto}))){var clonedTable=(dt.table().node().offsetWidth,dt.columns,dt.table().node().cloneNode(!1)),clonedHeader=$(dt.table().header().cloneNode(!1)).appendTo(clonedTable),clonedBody=$(dt.table().body()).clone(!1,!1).empty().appendTo(clonedTable),headerCells=dt.columns().header().filter(function(idx){return dt.column(idx).visible()}).to$().clone(!1).css("display","table-cell");$(clonedBody).append($(dt.rows({page:"current"}).nodes()).clone(!1)).find("th, td").css("display","");var footer=dt.table().footer();if(footer){var clonedFooter=$(footer.cloneNode(!1)).appendTo(clonedTable),footerCells=dt.columns().header().filter(function(idx){return dt.column(idx).visible()}).to$().clone(!1).css("display","table-cell");$("<tr/>").append(footerCells).appendTo(clonedFooter)}$("<tr/>").append(headerCells).appendTo(clonedHeader),"inline"===this.c.details.type&&$(clonedTable).addClass("dtr-inline collapsed");var inserted=$("<div/>").css({width:1,height:1,overflow:"hidden"}).append(clonedTable);inserted.insertBefore(dt.table().node()),headerCells.each(function(i){var idx=dt.column.index("fromVisible",i);columns[idx].minWidth=this.offsetWidth||0}),inserted.remove()}},_setColumnVis:function(col,showHide){var dt=this.s.dt,display=showHide?"":"none";$(dt.column(col).header()).css("display",display),$(dt.column(col).footer()).css("display",display),dt.column(col).nodes().to$().css("display",display)},_tabIndexes:function(){var dt=this.s.dt,cells=dt.cells({page:"current"}).nodes().to$(),ctx=dt.settings()[0],target=this.c.details.target;cells.filter("[data-dtr-keyboard]").removeData("[data-dtr-keyboard]");var selector="number"==typeof target?":eq("+target+")":target;$(selector,dt.rows({page:"current"}).nodes()).attr("tabIndex",ctx.iTabIndex).data("dtr-keyboard",1)}}),Responsive.breakpoints=[{name:"desktop",width:1/0},{name:"tablet-l",width:1024},{name:"tablet-p",width:768},{name:"mobile-l",width:480},{name:"mobile-p",width:320}],Responsive.display={childRow:function(row,update,render){return update?$(row.node()).hasClass("parent")?(row.child(render(),"child").show(),!0):void 0:row.child.isShown()?(row.child(!1),$(row.node()).removeClass("parent"),!1):(row.child(render(),"child").show(),$(row.node()).addClass("parent"),!0)},childRowImmediate:function(row,update,render){return!update&&row.child.isShown()||!row.responsive.hasHidden()?(row.child(!1),$(row.node()).removeClass("parent"),!1):(row.child(render(),"child").show(),$(row.node()).addClass("parent"),!0)},modal:function(options){return function(row,update,render){if(update)$("div.dtr-modal-content").empty().append(render());else{var close=function(){modal.remove(),$(document).off("keypress.dtr")},modal=$('<div class="dtr-modal"/>').append($('<div class="dtr-modal-display"/>').append($('<div class="dtr-modal-content"/>').append(render())).append($('<div class="dtr-modal-close">&times;</div>').click(function(){close()}))).append($('<div class="dtr-modal-background"/>').click(function(){close()})).appendTo("body");$(document).on("keyup.dtr",function(e){27===e.keyCode&&(e.stopPropagation(),close())})}options&&options.header&&$("div.dtr-modal-content").prepend("<h2>"+options.header(row)+"</h2>")}}},Responsive.defaults={breakpoints:Responsive.breakpoints,auto:!0,details:{display:Responsive.display.childRow,renderer:function(api,rowIdx,columns){var data=$.map(columns,function(col,i){return col.hidden?'<li data-dtr-index="'+col.columnIndex+'" data-dt-row="'+col.rowIndex+'" data-dt-column="'+col.columnIndex+'"><span class="dtr-title">'+col.title+'</span> <span class="dtr-data">'+col.data+"</span></li>":""}).join("");return data?$('<ul data-dtr-index="'+rowIdx+'"/>').append(data):!1},target:0,type:"inline"},orthogonal:"display"};var Api=$.fn.dataTable.Api;return Api.register("responsive()",function(){return this}),Api.register("responsive.index()",function(li){return li=$(li),{column:li.data("dtr-index"),row:li.parent().data("dtr-index")}}),Api.register("responsive.rebuild()",function(){return this.iterator("table",function(ctx){ctx._responsive&&ctx._responsive._classLogic()})}),Api.register("responsive.recalc()",function(){return this.iterator("table",function(ctx){ctx._responsive&&(ctx._responsive._resizeAuto(),ctx._responsive._resize())})}),Api.register("responsive.hasHidden()",function(){var ctx=this.context[0];return ctx._responsive?-1!==$.inArray(!1,ctx._responsive.s.current):!1}),Responsive.version="2.0.2",$.fn.dataTable.Responsive=Responsive,$.fn.DataTable.Responsive=Responsive,$(document).on("preInit.dt.dtr",function(e,settings,json){if("dt"===e.namespace&&($(settings.nTable).hasClass("responsive")||$(settings.nTable).hasClass("dt-responsive")||settings.oInit.responsive||DataTable.defaults.responsive)){var init=settings.oInit.responsive;init!==!1&&new Responsive(settings,$.isPlainObject(init)?init:{})}}),Responsive});